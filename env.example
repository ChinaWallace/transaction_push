# TradingView功能和策略系统配置示例
# 复制此文件为 .env 并根据需要修改配置

# =============================================================================
# 基础应用配置
# =============================================================================
APP_NAME=Python Trading Tool
APP_VERSION=1.1.0
DEBUG=true
LOG_LEVEL=INFO
HOST=0.0.0.0
PORT=8000

# =============================================================================
# 交易所选择配置
# =============================================================================
# 支持的交易所提供商: okx, binance
# 系统将根据此配置只启动对应交易所的服务
EXCHANGE_PROVIDER=okx

# =============================================================================
# 数据库配置
# =============================================================================
DATABASE_URL=mysql+pymysql://root:password@localhost:3306/trading_db
DATABASE_ECHO=false

# =============================================================================
# 币安API配置 (当EXCHANGE_PROVIDER=binance时必填)
# =============================================================================
BINANCE_API_KEY=your_binance_api_key_here
BINANCE_SECRET_KEY=your_binance_secret_key_here
BINANCE_TESTNET=false
BINANCE_BASE_URL=https://fapi.binance.com
# 币安WebSocket配置
BINANCE_WEBSOCKET_URL=wss://fstream.binance.com/ws/
BINANCE_ENABLE_WEBSOCKET=true

# =============================================================================
# OKX API配置 (当EXCHANGE_PROVIDER=okx时必填)
# =============================================================================
OKX_API_KEY=你的
OKX_SECRET_KEY=你的
OKX_PASSPHRASE=你的
OKX_SANDBOX=false
OKX_BASE_URL=https://www.okx.com

# =============================================================================
# 代理配置 (可选)
# =============================================================================
PROXY_ENABLED=false
PROXY_URL=http://127.0.0.1:7890

# =============================================================================
# TradingView功能配置
# =============================================================================
# 启用Pine Script风格指标
TRADINGVIEW_CONFIG__ENABLE_PINE_INDICATORS=true

# 启用成交量分布分析
TRADINGVIEW_CONFIG__ENABLE_VOLUME_PROFILE=true

# 启用订单流分析 (消耗更多资源)
TRADINGVIEW_CONFIG__ENABLE_ORDER_FLOW=false

# 支持的图表时间周期
TRADINGVIEW_CONFIG__CHART_TIMEFRAMES=["1m","5m","15m","1h","4h","1d"]

# =============================================================================
# 策略配置
# =============================================================================
# SuperTrend策略参数
STRATEGY_CONFIG__SUPERTREND__PERIOD=10
STRATEGY_CONFIG__SUPERTREND__MULTIPLIER=3.0
STRATEGY_CONFIG__SUPERTREND__TIMEFRAMES=["1d","4h","1h","15m"]

# 成交量策略参数
STRATEGY_CONFIG__VOLUME__THRESHOLD_MULTIPLIER=3.0
STRATEGY_CONFIG__VOLUME__CONSECUTIVE_PERIODS=3

# 资金费率策略参数
STRATEGY_CONFIG__FUNDING_RATE__NEGATIVE_THRESHOLD=-0.001
STRATEGY_CONFIG__FUNDING_RATE__HIGH_THRESHOLD=0.1

# =============================================================================
# 数据缓存配置
# =============================================================================
# 启用数据缓存
CACHE_CONFIG__ENABLE_CACHE=true

# 缓存过期时间 (分钟)
CACHE_CONFIG__CACHE_TTL_MINUTES=5

# 最大缓存大小 (MB)
CACHE_CONFIG__MAX_CACHE_SIZE_MB=100

# 启用缓存压缩
CACHE_CONFIG__CACHE_COMPRESSION=true

# =============================================================================
# 监控参数配置
# =============================================================================
# 持仓量变化阈值 (1.05 = 5%增长触发)
OPEN_INTEREST_THRESHOLD=1.05

# 成交量异常倍数
VOLUME_MULTIPLIER=3.0

# 各种监控间隔 (分钟)
FUNDING_RATE_INTERVAL=240
TREND_ANALYSIS_INTERVAL=15
OPEN_INTEREST_INTERVAL=5
VOLUME_MONITOR_INTERVAL=60

# =============================================================================
# 通知推送配置 (至少配置一个)
# =============================================================================
# 飞书机器人
FEISHU_WEBHOOK_URL=https://open.feishu.cn/open-apis/bot/v2/hook/your_webhook_key

# 企业微信机器人
WECHAT_WEBHOOK_URL=https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=your_key

# Telegram机器人
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_CHAT_ID=your_chat_id

# 邮件通知
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_email_password
SMTP_FROM=your_email@gmail.com

# =============================================================================
# 日志配置
# =============================================================================
LOG_FORMAT=text
LOG_ROTATION=1 day
LOG_RETENTION=30 days
LOG_PATH=logs/

# =============================================================================
# 安全配置
# =============================================================================
SECRET_KEY=your_secret_key_here
ACCESS_TOKEN_EXPIRE_MINUTES=30
RATE_LIMIT_PER_MINUTE=60

# =============================================================================
# 任务调度配置
# =============================================================================
SCHEDULER_TIMEZONE=Asia/Shanghai
DATA_RETENTION_DAYS=30

# =============================================================================
# 机器学习增强配置
# =============================================================================
# 启用ML功能
ML_CONFIG__ENABLE_ML_PREDICTION=true
ML_CONFIG__ENABLE_ANOMALY_DETECTION=true
ML_CONFIG__ENABLE_ADAPTIVE_OPTIMIZATION=true

# 预测模型配置
ML_CONFIG__PREDICTION_MODEL__MODEL_TYPE=random_forest
ML_CONFIG__PREDICTION_MODEL__LOOKBACK_PERIODS=50
ML_CONFIG__PREDICTION_MODEL__PREDICTION_HORIZON=5
ML_CONFIG__PREDICTION_MODEL__RETRAIN_INTERVAL_HOURS=24
ML_CONFIG__PREDICTION_MODEL__MIN_ACCURACY_THRESHOLD=0.6

# 异常检测配置
ML_CONFIG__ANOMALY_DETECTION__ALGORITHM=isolation_forest
ML_CONFIG__ANOMALY_DETECTION__CONTAMINATION=0.1
ML_CONFIG__ANOMALY_DETECTION__SENSITIVITY=0.8
ML_CONFIG__ANOMALY_DETECTION__MIN_SAMPLES=100

# 自适应优化配置
ML_CONFIG__ADAPTIVE_OPTIMIZATION__ENABLE_PARAMETER_TUNING=true
ML_CONFIG__ADAPTIVE_OPTIMIZATION__OPTIMIZATION_INTERVAL_HOURS=12
ML_CONFIG__ADAPTIVE_OPTIMIZATION__PERFORMANCE_WINDOW_DAYS=7
ML_CONFIG__ADAPTIVE_OPTIMIZATION__MIN_IMPROVEMENT_THRESHOLD=0.05

# 特征工程配置
ML_CONFIG__FEATURE_ENGINEERING__TECHNICAL_INDICATORS=true
ML_CONFIG__FEATURE_ENGINEERING__PRICE_PATTERNS=true
ML_CONFIG__FEATURE_ENGINEERING__VOLUME_FEATURES=true
ML_CONFIG__FEATURE_ENGINEERING__MARKET_MICROSTRUCTURE=true

# =============================================================================
# Kronos AI预测配置 (基于项目实际默认值)
# =============================================================================
# 启用Kronos AI预测功能
KRONOS_CONFIG__ENABLE_KRONOS_PREDICTION=true

# 模型基础配置
KRONOS_CONFIG__USE_LOCAL_MODEL=true
KRONOS_CONFIG__LOCAL_MODEL_PATH=./Kronos-master
KRONOS_CONFIG__USE_GPU=false

# 模型配置 (基于config.py中的默认值)
KRONOS_CONFIG__MODEL_NAME=NeoQuasar/Kronos-Tokenizer-base
KRONOS_CONFIG__TOKENIZER_NAME=NeoQuasar/Kronos-Tokenizer-base
KRONOS_CONFIG__MAX_CONTEXT=256
KRONOS_CONFIG__LOOKBACK_PERIODS=100
KRONOS_CONFIG__PREDICTION_HORIZON=12

# 采样参数 (基于config.py中的sampling_params)
KRONOS_CONFIG__TEMPERATURE=0.8
KRONOS_CONFIG__TOP_P=0.9
KRONOS_CONFIG__SAMPLE_COUNT=3

# 其他配置 (基于config.py和代码中的默认值)
KRONOS_CONFIG__CONFIDENCE_THRESHOLD=0.25
KRONOS_CONFIG__UPDATE_INTERVAL_MINUTES=5
KRONOS_CONFIG__CACHE_PREDICTIONS=true
KRONOS_CONFIG__DEVICE=cpu
KRONOS_CONFIG__PREDICTION_TIMEOUT=120
KRONOS_CONFIG__MAX_RETRIES=2
KRONOS_CONFIG__TARGET_SYMBOLS=["BTC-USDT-SWAP","ETH-USDT-SWAP","SOL-USDT-SWAP","ADA-USDT-SWAP","DOGE-USDT-SWAP"]

# 高级配置 (基于config.py)
KRONOS_CONFIG__ENHANCED_ANALYSIS=true
KRONOS_CONFIG__STRICT_KRONOS_ONLY=true
KRONOS_CONFIG__DISABLE_TRADITIONAL_SIGNALS=true

# =============================================================================
# 监控币种配置
# =============================================================================
# 监控的交易对列表 (OKX格式)
MONITORED_SYMBOLS=["BTC-USDT-SWAP","ETH-USDT-SWAP","SOL-USDT-SWAP","DOGE-USDT-SWAP","XRP-USDT-SWAP"]

# =============================================================================
# 交易所配置说明
# =============================================================================

# 交易所选择说明:
# - 设置 EXCHANGE_PROVIDER=okx 使用OKX交易所 (推荐)
# - 设置 EXCHANGE_PROVIDER=binance 使用币安交易所
# - 系统将根据选择只启动对应交易所的服务，节省资源
# - 切换交易所需要重启服务

# OKX交易所特点:
# - 支持更多交易对
# - WebSocket连接稳定
# - API限制相对宽松
# - 推荐用于专业交易

# 币安交易所特点:
# - 全球最大交易量
# - 流动性好
# - 适合大资金交易
# - API调用频率限制较严格

# =============================================================================
# 性能优化配置建议
# =============================================================================

# 高性能配置 (适合服务器环境)
# CACHE_CONFIG__MAX_CACHE_SIZE_MB=200
# CACHE_CONFIG__CACHE_TTL_MINUTES=10
# TRADINGVIEW_CONFIG__ENABLE_ORDER_FLOW=true
# ML_CONFIG__PREDICTION_MODEL__LOOKBACK_PERIODS=100

# 低资源配置 (适合个人电脑)
# CACHE_CONFIG__MAX_CACHE_SIZE_MB=50
# TRADINGVIEW_CONFIG__ENABLE_ORDER_FLOW=false
# TRADINGVIEW_CONFIG__CHART_TIMEFRAMES=["1h","4h","1d"]
# ML_CONFIG__ENABLE_ADAPTIVE_OPTIMIZATION=false

# 开发环境配置
# DEBUG=true
# LOG_LEVEL=DEBUG
# DATABASE_ECHO=true
# CACHE_CONFIG__ENABLE_CACHE=false
# ML_CONFIG__PREDICTION_MODEL__MIN_ACCURACY_THRESHOLD=0.5

# =============================================================================
# 依赖管理配置
# =============================================================================
# 启用依赖检查
DEPENDENCY_CONFIG__ENABLE_DEPENDENCY_CHECK=true

# 依赖检查间隔(分钟)
DEPENDENCY_CONFIG__CHECK_INTERVAL_MINUTES=60

# 是否自动安装缺失依赖(生产环境建议false)
DEPENDENCY_CONFIG__AUTO_INSTALL_MISSING=false

# 启用回退模式
DEPENDENCY_CONFIG__FALLBACK_CONFIG__ENABLE_FALLBACK_MODE=true
DEPENDENCY_CONFIG__FALLBACK_CONFIG__FALLBACK_TIMEOUT_SECONDS=30
DEPENDENCY_CONFIG__FALLBACK_CONFIG__MAX_FALLBACK_ATTEMPTS=3

# =============================================================================
# 服务初始化配置
# =============================================================================
# 服务初始化超时时间(秒)
SERVICE_CONFIG__INITIALIZATION_TIMEOUT=120

# 启动重试配置
SERVICE_CONFIG__STARTUP_RETRY_ATTEMPTS=3
SERVICE_CONFIG__STARTUP_RETRY_DELAY=5

# 优雅关闭超时(秒)
SERVICE_CONFIG__GRACEFUL_SHUTDOWN_TIMEOUT=30

# 健康检查间隔(秒)
SERVICE_CONFIG__HEALTH_CHECK_INTERVAL=60

# 故障处理配置
SERVICE_CONFIG__FAILURE_HANDLING__CONTINUE_ON_OPTIONAL_FAILURE=true
SERVICE_CONFIG__FAILURE_HANDLING__MAX_FAILED_SERVICES=2
SERVICE_CONFIG__FAILURE_HANDLING__ENABLE_SERVICE_RECOVERY=true
SERVICE_CONFIG__FAILURE_HANDLING__RECOVERY_CHECK_INTERVAL=300
SERVICE_CONFIG__FAILURE_HANDLING__AUTO_RESTART_FAILED_SERVICES=true

# 资源限制配置
SERVICE_CONFIG__RESOURCE_LIMITS__MAX_MEMORY_MB=2048
SERVICE_CONFIG__RESOURCE_LIMITS__MAX_CPU_PERCENT=80
SERVICE_CONFIG__RESOURCE_LIMITS__MAX_CONCURRENT_TASKS=50

# =============================================================================
# 回退服务配置
# =============================================================================
# 启用回退服务
FALLBACK_CONFIG__ENABLE_FALLBACK_SERVICES=true
FALLBACK_CONFIG__FALLBACK_TIMEOUT=30

# 预测回退配置
FALLBACK_CONFIG__PREDICTION_FALLBACK__ENABLE=true
FALLBACK_CONFIG__PREDICTION_FALLBACK__METHOD=simple_technical_analysis
FALLBACK_CONFIG__PREDICTION_FALLBACK__CONFIDENCE_PENALTY=0.3
FALLBACK_CONFIG__PREDICTION_FALLBACK__CACHE_DURATION_MINUTES=15

# 数据回退配置
FALLBACK_CONFIG__DATA_FALLBACK__ENABLE=true
FALLBACK_CONFIG__DATA_FALLBACK__USE_CACHED_DATA=true
FALLBACK_CONFIG__DATA_FALLBACK__MAX_CACHE_AGE_MINUTES=30
FALLBACK_CONFIG__DATA_FALLBACK__RETRY_ORIGINAL_AFTER_MINUTES=10

# 通知回退配置
FALLBACK_CONFIG__NOTIFICATION_FALLBACK__ENABLE=true
FALLBACK_CONFIG__NOTIFICATION_FALLBACK__LOG_FAILED_NOTIFICATIONS=true

# 分析回退配置
FALLBACK_CONFIG__ANALYSIS_FALLBACK__ENABLE=true
FALLBACK_CONFIG__ANALYSIS_FALLBACK__USE_BASIC_INDICATORS=true
FALLBACK_CONFIG__ANALYSIS_FALLBACK__DISABLE_ADVANCED_FEATURES=true

# =============================================================================
# API增强错误处理配置
# =============================================================================
# 启用增强错误处理
API_ERROR_HANDLING_CONFIG__ENABLE_ENHANCED_ERROR_HANDLING=true

# 重试配置
API_ERROR_HANDLING_CONFIG__MAX_RETRY_ATTEMPTS=5
API_ERROR_HANDLING_CONFIG__BASE_RETRY_DELAY=1.0
API_ERROR_HANDLING_CONFIG__MAX_RETRY_DELAY=60.0
API_ERROR_HANDLING_CONFIG__EXPONENTIAL_BACKOFF_FACTOR=2.0
API_ERROR_HANDLING_CONFIG__JITTER_ENABLED=true

# 熔断器配置
API_ERROR_HANDLING_CONFIG__CIRCUIT_BREAKER__ENABLE=true
API_ERROR_HANDLING_CONFIG__CIRCUIT_BREAKER__FAILURE_THRESHOLD=5
API_ERROR_HANDLING_CONFIG__CIRCUIT_BREAKER__RECOVERY_TIMEOUT=60
API_ERROR_HANDLING_CONFIG__CIRCUIT_BREAKER__HALF_OPEN_MAX_CALLS=3

# 限流配置
API_ERROR_HANDLING_CONFIG__RATE_LIMITING__ENABLE=true
API_ERROR_HANDLING_CONFIG__RATE_LIMITING__REQUESTS_PER_SECOND=10
API_ERROR_HANDLING_CONFIG__RATE_LIMITING__BURST_SIZE=20
API_ERROR_HANDLING_CONFIG__RATE_LIMITING__ADAPTIVE_RATE_LIMITING=true

# 超时配置
API_ERROR_HANDLING_CONFIG__TIMEOUT_CONFIG__CONNECT_TIMEOUT=10
API_ERROR_HANDLING_CONFIG__TIMEOUT_CONFIG__READ_TIMEOUT=30
API_ERROR_HANDLING_CONFIG__TIMEOUT_CONFIG__TOTAL_TIMEOUT=60
API_ERROR_HANDLING_CONFIG__TIMEOUT_CONFIG__ADAPTIVE_TIMEOUT=true

# 监控配置
API_ERROR_HANDLING_CONFIG__MONITORING__TRACK_ERROR_RATES=true
API_ERROR_HANDLING_CONFIG__MONITORING__ALERT_ON_HIGH_ERROR_RATE=true
API_ERROR_HANDLING_CONFIG__MONITORING__ERROR_RATE_THRESHOLD=0.1
API_ERROR_HANDLING_CONFIG__MONITORING__ALERT_COOLDOWN_MINUTES=15